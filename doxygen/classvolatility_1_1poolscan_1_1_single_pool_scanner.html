<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>The Volatility Framework: volatility.poolscan.SinglePoolScanner Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="vol.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">The Volatility Framework
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classvolatility_1_1poolscan_1_1_single_pool_scanner.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classvolatility_1_1poolscan_1_1_single_pool_scanner-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">volatility.poolscan.SinglePoolScanner Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for volatility.poolscan.SinglePoolScanner:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classvolatility_1_1poolscan_1_1_single_pool_scanner.png" usemap="#volatility.poolscan.SinglePoolScanner_map" alt=""/>
  <map id="volatility.poolscan.SinglePoolScanner_map" name="volatility.poolscan.SinglePoolScanner_map">
<area href="classvolatility_1_1scan_1_1_base_scanner.html" title="Following is the new implementation of the scanning framework. " alt="volatility.scan.BaseScanner" shape="rect" coords="0,56,273,80"/>
<area href="classvolatility_1_1plugins_1_1pooltracker_1_1_generic_pool_scan.html" title="Configurable pool scanner. " alt="volatility.plugins.pooltracker.GenericPoolScan" shape="rect" coords="0,168,273,192"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a358ab4ec07714f75359210a83b3d3674"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1poolscan_1_1_single_pool_scanner.html#a358ab4ec07714f75359210a83b3d3674">object_offset</a></td></tr>
<tr class="memdesc:a358ab4ec07714f75359210a83b3d3674"><td class="mdescLeft">&#160;</td><td class="mdescRight">The name of this function "object_offset" can be misleading depending on how its used.  <a href="#a358ab4ec07714f75359210a83b3d3674">More...</a><br /></td></tr>
<tr class="separator:a358ab4ec07714f75359210a83b3d3674"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92f490799feb875bbca3c972604a4c6a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a92f490799feb875bbca3c972604a4c6a"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>scan</b></td></tr>
<tr class="separator:a92f490799feb875bbca3c972604a4c6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classvolatility_1_1scan_1_1_base_scanner"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classvolatility_1_1scan_1_1_base_scanner')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classvolatility_1_1scan_1_1_base_scanner.html">volatility.scan.BaseScanner</a></td></tr>
<tr class="memitem:a44f3cc8bebc6bca9ebee96a4da473963 inherit pub_methods_classvolatility_1_1scan_1_1_base_scanner"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a44f3cc8bebc6bca9ebee96a4da473963"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>__init__</b></td></tr>
<tr class="separator:a44f3cc8bebc6bca9ebee96a4da473963 inherit pub_methods_classvolatility_1_1scan_1_1_base_scanner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6eeb59375f60883beaa2f4f144d0c46 inherit pub_methods_classvolatility_1_1scan_1_1_base_scanner"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1scan_1_1_base_scanner.html#ab6eeb59375f60883beaa2f4f144d0c46">check_addr</a></td></tr>
<tr class="memdesc:ab6eeb59375f60883beaa2f4f144d0c46 inherit pub_methods_classvolatility_1_1scan_1_1_base_scanner"><td class="mdescLeft">&#160;</td><td class="mdescRight">This calls all our constraints on the offset found and returns the number of contraints that matched.  <a href="#ab6eeb59375f60883beaa2f4f144d0c46">More...</a><br /></td></tr>
<tr class="separator:ab6eeb59375f60883beaa2f4f144d0c46 inherit pub_methods_classvolatility_1_1scan_1_1_base_scanner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a897c3abd432f06e766ed19d9561c4ec8 inherit pub_methods_classvolatility_1_1scan_1_1_base_scanner"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a897c3abd432f06e766ed19d9561c4ec8"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>scan</b></td></tr>
<tr class="separator:a897c3abd432f06e766ed19d9561c4ec8 inherit pub_methods_classvolatility_1_1scan_1_1_base_scanner"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_attribs_classvolatility_1_1scan_1_1_base_scanner"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classvolatility_1_1scan_1_1_base_scanner')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classvolatility_1_1scan_1_1_base_scanner.html">volatility.scan.BaseScanner</a></td></tr>
<tr class="memitem:aacd205b60a9a45ff12c038036c835db9 inherit pub_attribs_classvolatility_1_1scan_1_1_base_scanner"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aacd205b60a9a45ff12c038036c835db9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>buffer</b></td></tr>
<tr class="separator:aacd205b60a9a45ff12c038036c835db9 inherit pub_attribs_classvolatility_1_1scan_1_1_base_scanner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85dab23e291568d5a5e5c95a74db82c9 inherit pub_attribs_classvolatility_1_1scan_1_1_base_scanner"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a85dab23e291568d5a5e5c95a74db82c9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>window_size</b></td></tr>
<tr class="separator:a85dab23e291568d5a5e5c95a74db82c9 inherit pub_attribs_classvolatility_1_1scan_1_1_base_scanner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66518697a2c034cc772643edac5ea35f inherit pub_attribs_classvolatility_1_1scan_1_1_base_scanner"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a66518697a2c034cc772643edac5ea35f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1scan_1_1_base_scanner.html#a66518697a2c034cc772643edac5ea35f">constraints</a></td></tr>
<tr class="memdesc:a66518697a2c034cc772643edac5ea35f inherit pub_attribs_classvolatility_1_1scan_1_1_base_scanner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build our constraints from the specified <a class="el" href="classvolatility_1_1scan_1_1_scanner_check.html" title="A scanner check is a special class which is invoked on an AS to check for a specific condition...">ScannerCheck</a> classes: <br /></td></tr>
<tr class="separator:a66518697a2c034cc772643edac5ea35f inherit pub_attribs_classvolatility_1_1scan_1_1_base_scanner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e395d35b1bbbcd5fcb53dd4cb53a7fc inherit pub_attribs_classvolatility_1_1scan_1_1_base_scanner"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6e395d35b1bbbcd5fcb53dd4cb53a7fc"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>error_count</b></td></tr>
<tr class="separator:a6e395d35b1bbbcd5fcb53dd4cb53a7fc inherit pub_attribs_classvolatility_1_1scan_1_1_base_scanner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_attribs_classvolatility_1_1scan_1_1_base_scanner"><td colspan="2" onclick="javascript:toggleInherit('pub_static_attribs_classvolatility_1_1scan_1_1_base_scanner')"><img src="closed.png" alt="-"/>&#160;Static Public Attributes inherited from <a class="el" href="classvolatility_1_1scan_1_1_base_scanner.html">volatility.scan.BaseScanner</a></td></tr>
<tr class="memitem:ab08a6473c164de49aae1e069e171fcb3 inherit pub_static_attribs_classvolatility_1_1scan_1_1_base_scanner"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab08a6473c164de49aae1e069e171fcb3"></a>
list&#160;</td><td class="memItemRight" valign="bottom"><b>checks</b> = []</td></tr>
<tr class="separator:ab08a6473c164de49aae1e069e171fcb3 inherit pub_static_attribs_classvolatility_1_1scan_1_1_base_scanner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e881391e0506792309c6f6a4793cb4c inherit pub_static_attribs_classvolatility_1_1scan_1_1_base_scanner"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4e881391e0506792309c6f6a4793cb4c"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>overlap</b> = 20</td></tr>
<tr class="separator:a4e881391e0506792309c6f6a4793cb4c inherit pub_static_attribs_classvolatility_1_1scan_1_1_base_scanner"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a358ab4ec07714f75359210a83b3d3674"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def volatility.poolscan.SinglePoolScanner.object_offset </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>found</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>address_space</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The name of this function "object_offset" can be misleading depending on how its used. </p>
<p>Even before removing the preambles (r1324), it may not always return the offset of an object. Here are the rules:</p>
<p>If you subclass <a class="el" href="classvolatility_1_1poolscan_1_1_pool_scanner.html" title="A generic pool scanner class. ">PoolScanner</a> and do not override this function, it will return the offset of _POOL_HEADER. If you do override this function, it should be used to calculate and return the offset of your desired object within the pool. Thus there are two different ways it can be done.</p>
<p>Example 1.</p>
<p>For an example of subclassing <a class="el" href="classvolatility_1_1poolscan_1_1_pool_scanner.html" title="A generic pool scanner class. ">PoolScanner</a> and not overriding this function, see filescan.PoolScanFile. In this case, the plugin (filescan.FileScan) treats the offset returned by this function as the start of _POOL_HEADER and then works out the object from the bottom up: </p><pre class="fragment">for offset in PoolScanFile().scan(address_space):
    pool_obj = obj.Object("_POOL_HEADER", vm = address_space,
         offset = offset)
    ##
    ## Work out objects base here
    ## 
</pre><p>Example 2.</p>
<p>For an example of subclassing <a class="el" href="classvolatility_1_1poolscan_1_1_pool_scanner.html" title="A generic pool scanner class. ">PoolScanner</a> and overriding this function, see filescan.PoolScanProcess. In this case, the "work" described above is done here (in the sublcassed object_offset). Thus in the plugin (filescan.PSScan) it can directly instantiate _EPROCESS from the offset we return. </p><pre class="fragment">for offset in PoolScanProcess().scan(address_space):
    eprocess = obj.Object('_EPROCESS', vm = address_space,
            native_vm = kernel_as, offset = offset)</pre> 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>volatility/poolscan.py</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>volatility</b></li><li class="navelem"><b>poolscan</b></li><li class="navelem"><a class="el" href="classvolatility_1_1poolscan_1_1_single_pool_scanner.html">SinglePoolScanner</a></li>
    <li class="footer">Generated on Fri Sep 5 2014 15:58:33 for The Volatility Framework by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
