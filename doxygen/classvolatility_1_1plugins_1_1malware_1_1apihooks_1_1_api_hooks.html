<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>The Volatility Framework: volatility.plugins.malware.apihooks.ApiHooks Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="vol.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">The Volatility Framework
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_api_hooks.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_api_hooks-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">volatility.plugins.malware.apihooks.ApiHooks Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Detect API hooks in process and kernel memory.  
 <a href="classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_api_hooks.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for volatility.plugins.malware.apihooks.ApiHooks:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_api_hooks.png" usemap="#volatility.plugins.malware.apihooks.ApiHooks_map" alt=""/>
  <map id="volatility.plugins.malware.apihooks.ApiHooks_map" name="volatility.plugins.malware.apihooks.ApiHooks_map">
<area href="classvolatility_1_1plugins_1_1procdump_1_1_proc_dump.html" title="Dump a process to an executable file sample. " alt="volatility.plugins.procdump.ProcDump" shape="rect" coords="159,224,467,248"/>
<area href="classvolatility_1_1plugins_1_1taskmods_1_1_dll_list.html" title="Print list of loaded dlls for each process. " alt="volatility.plugins.taskmods.DllList" shape="rect" coords="159,168,467,192"/>
<area href="classvolatility_1_1plugins_1_1common_1_1_abstract_windows_command.html" alt="volatility.plugins.common.AbstractWindowsCommand" shape="rect" coords="0,112,308,136"/>
<area href="classvolatility_1_1cache_1_1_testable.html" title="This is a mixin that makes a class response to the unit tests. " alt="volatility.cache.Testable" shape="rect" coords="318,112,626,136"/>
<area href="classvolatility_1_1commands_1_1_command.html" title="Base class for each plugin command. " alt="volatility.commands.Command" shape="rect" coords="0,56,308,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a10210fc6a98a06b57cb594d6de2e0b03"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a10210fc6a98a06b57cb594d6de2e0b03"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>__init__</b></td></tr>
<tr class="separator:a10210fc6a98a06b57cb594d6de2e0b03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a4a5f5a13fdb49cb639b2ac60411dd0"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_api_hooks.html#a4a4a5f5a13fdb49cb639b2ac60411dd0">compile</a></td></tr>
<tr class="memdesc:a4a4a5f5a13fdb49cb639b2ac60411dd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Precompile the regular expression rules.  <a href="#a4a4a5f5a13fdb49cb639b2ac60411dd0">More...</a><br /></td></tr>
<tr class="separator:a4a4a5f5a13fdb49cb639b2ac60411dd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f413f572e43b591dee349f8ad1ba780"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_api_hooks.html#a8f413f572e43b591dee349f8ad1ba780">whitelist</a></td></tr>
<tr class="memdesc:a8f413f572e43b591dee349f8ad1ba780"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if an API hook should be ignored due to whitelisting.  <a href="#a8f413f572e43b591dee349f8ad1ba780">More...</a><br /></td></tr>
<tr class="separator:a8f413f572e43b591dee349f8ad1ba780"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d204b13397279c39b45316fa6605474"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_api_hooks.html#a0d204b13397279c39b45316fa6605474">check_ucpcall</a></td></tr>
<tr class="memdesc:a0d204b13397279c39b45316fa6605474"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scan for calls to unknown code pages.  <a href="#a0d204b13397279c39b45316fa6605474">More...</a><br /></td></tr>
<tr class="separator:a0d204b13397279c39b45316fa6605474"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5de35852004115e823a6d9ab67457e63"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_api_hooks.html#a5de35852004115e823a6d9ab67457e63">check_wsp</a></td></tr>
<tr class="memdesc:a5de35852004115e823a6d9ab67457e63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for hooks of non-exported WSP* functions.  <a href="#a5de35852004115e823a6d9ab67457e63">More...</a><br /></td></tr>
<tr class="separator:a5de35852004115e823a6d9ab67457e63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae71ed2a9b0571ade282efd07c5c4b46f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_api_hooks.html#ae71ed2a9b0571ade282efd07c5c4b46f">gather_stuff</a></td></tr>
<tr class="memdesc:ae71ed2a9b0571ade282efd07c5c4b46f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use the Volatility object classes to enumerate imports and exports.  <a href="#ae71ed2a9b0571ade282efd07c5c4b46f">More...</a><br /></td></tr>
<tr class="separator:ae71ed2a9b0571ade282efd07c5c4b46f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd27c2da01b9f5b3091f5ccef25a6448"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_api_hooks.html#afd27c2da01b9f5b3091f5ccef25a6448">get_hooks</a></td></tr>
<tr class="memdesc:afd27c2da01b9f5b3091f5ccef25a6448"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerate IAT, EAT, Inline hooks.  <a href="#afd27c2da01b9f5b3091f5ccef25a6448">More...</a><br /></td></tr>
<tr class="separator:afd27c2da01b9f5b3091f5ccef25a6448"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af865c769ed5c1d60ddd7a98c598e97af"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af865c769ed5c1d60ddd7a98c598e97af"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>calculate</b></td></tr>
<tr class="separator:af865c769ed5c1d60ddd7a98c598e97af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad35001c292973eb524a1ee836b915894"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad35001c292973eb524a1ee836b915894"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>render_text</b></td></tr>
<tr class="separator:ad35001c292973eb524a1ee836b915894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classvolatility_1_1plugins_1_1procdump_1_1_proc_dump"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classvolatility_1_1plugins_1_1procdump_1_1_proc_dump')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classvolatility_1_1plugins_1_1procdump_1_1_proc_dump.html">volatility.plugins.procdump.ProcDump</a></td></tr>
<tr class="memitem:ad82671c1e3d893c59b324e1d01898944 inherit pub_methods_classvolatility_1_1plugins_1_1procdump_1_1_proc_dump"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad82671c1e3d893c59b324e1d01898944"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>__init__</b></td></tr>
<tr class="separator:ad82671c1e3d893c59b324e1d01898944 inherit pub_methods_classvolatility_1_1plugins_1_1procdump_1_1_proc_dump"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a123565c46cb048e87048562ed3f4d8fb inherit pub_methods_classvolatility_1_1plugins_1_1procdump_1_1_proc_dump"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1plugins_1_1procdump_1_1_proc_dump.html#a123565c46cb048e87048562ed3f4d8fb">dump_pe</a></td></tr>
<tr class="memdesc:a123565c46cb048e87048562ed3f4d8fb inherit pub_methods_classvolatility_1_1plugins_1_1procdump_1_1_proc_dump"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump a PE from an AS into a file.  <a href="#a123565c46cb048e87048562ed3f4d8fb">More...</a><br /></td></tr>
<tr class="separator:a123565c46cb048e87048562ed3f4d8fb inherit pub_methods_classvolatility_1_1plugins_1_1procdump_1_1_proc_dump"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5029f62d98cb8c0ceb5f0b8902ba3a9 inherit pub_methods_classvolatility_1_1plugins_1_1procdump_1_1_proc_dump"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab5029f62d98cb8c0ceb5f0b8902ba3a9"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1plugins_1_1procdump_1_1_proc_dump.html#ab5029f62d98cb8c0ceb5f0b8902ba3a9">render_text</a></td></tr>
<tr class="memdesc:ab5029f62d98cb8c0ceb5f0b8902ba3a9 inherit pub_methods_classvolatility_1_1plugins_1_1procdump_1_1_proc_dump"><td class="mdescLeft">&#160;</td><td class="mdescRight">Renders the tasks to disk images, outputting progress as they go. <br /></td></tr>
<tr class="separator:ab5029f62d98cb8c0ceb5f0b8902ba3a9 inherit pub_methods_classvolatility_1_1plugins_1_1procdump_1_1_proc_dump"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classvolatility_1_1plugins_1_1taskmods_1_1_dll_list.html">volatility.plugins.taskmods.DllList</a></td></tr>
<tr class="memitem:af4f10e97429cac0b18daa0549a10439d inherit pub_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af4f10e97429cac0b18daa0549a10439d"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>__init__</b></td></tr>
<tr class="separator:af4f10e97429cac0b18daa0549a10439d inherit pub_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a417b0f9730e127fe83d9b5cec84a9a36 inherit pub_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a417b0f9730e127fe83d9b5cec84a9a36"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>render_text</b></td></tr>
<tr class="separator:a417b0f9730e127fe83d9b5cec84a9a36 inherit pub_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0eb2631d1388a6b653bb075cb95acc42 inherit pub_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1plugins_1_1taskmods_1_1_dll_list.html#a0eb2631d1388a6b653bb075cb95acc42">filter_tasks</a></td></tr>
<tr class="memdesc:a0eb2631d1388a6b653bb075cb95acc42 inherit pub_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduce the tasks based on the user selectable PIDS parameter.  <a href="#a0eb2631d1388a6b653bb075cb95acc42">More...</a><br /></td></tr>
<tr class="separator:a0eb2631d1388a6b653bb075cb95acc42 inherit pub_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76093904af055c40ff614108f546390b inherit pub_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a76093904af055c40ff614108f546390b"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1plugins_1_1taskmods_1_1_dll_list.html#a76093904af055c40ff614108f546390b">calculate</a></td></tr>
<tr class="memdesc:a76093904af055c40ff614108f546390b inherit pub_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list"><td class="mdescLeft">&#160;</td><td class="mdescRight">Produces a list of processes, or just a single process based on an OFFSET. <br /></td></tr>
<tr class="separator:a76093904af055c40ff614108f546390b inherit pub_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classvolatility_1_1commands_1_1_command"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classvolatility_1_1commands_1_1_command')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classvolatility_1_1commands_1_1_command.html">volatility.commands.Command</a></td></tr>
<tr class="memitem:a5565c322192daa1ad58c9e63cacb4205 inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1commands_1_1_command.html#a5565c322192daa1ad58c9e63cacb4205">__init__</a></td></tr>
<tr class="memdesc:a5565c322192daa1ad58c9e63cacb4205 inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor uses args as an initializer.  <a href="#a5565c322192daa1ad58c9e63cacb4205">More...</a><br /></td></tr>
<tr class="separator:a5565c322192daa1ad58c9e63cacb4205 inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0af999d468c0e119318f42dd854e472f inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0af999d468c0e119318f42dd854e472f"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1commands_1_1_command.html#a0af999d468c0e119318f42dd854e472f">help</a></td></tr>
<tr class="memdesc:a0af999d468c0e119318f42dd854e472f inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns a string that will be displayed when a user lists available plugins. <br /></td></tr>
<tr class="separator:a0af999d468c0e119318f42dd854e472f inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf3ca9bb4022c2462c77b8fb99afdecf inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1commands_1_1_command.html#adf3ca9bb4022c2462c77b8fb99afdecf">calculate</a></td></tr>
<tr class="memdesc:adf3ca9bb4022c2462c77b8fb99afdecf inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is responsible for performing all calculations.  <a href="#adf3ca9bb4022c2462c77b8fb99afdecf">More...</a><br /></td></tr>
<tr class="separator:adf3ca9bb4022c2462c77b8fb99afdecf inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f51e538981d2e0026397be328de9ba7 inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1commands_1_1_command.html#a3f51e538981d2e0026397be328de9ba7">execute</a></td></tr>
<tr class="memdesc:a3f51e538981d2e0026397be328de9ba7 inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the plugin command.  <a href="#a3f51e538981d2e0026397be328de9ba7">More...</a><br /></td></tr>
<tr class="separator:a3f51e538981d2e0026397be328de9ba7 inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea069f82c6b2d78df624f1a4cbe5cf83 inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aea069f82c6b2d78df624f1a4cbe5cf83"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1commands_1_1_command.html#aea069f82c6b2d78df624f1a4cbe5cf83">format_value</a></td></tr>
<tr class="memdesc:aea069f82c6b2d78df624f1a4cbe5cf83 inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="mdescLeft">&#160;</td><td class="mdescRight">Formats an individual field using the table formatting codes. <br /></td></tr>
<tr class="separator:aea069f82c6b2d78df624f1a4cbe5cf83 inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a483b5fde06ea37439273c4e613012e inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1commands_1_1_command.html#a0a483b5fde06ea37439273c4e613012e">table_header</a></td></tr>
<tr class="memdesc:a0a483b5fde06ea37439273c4e613012e inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="mdescLeft">&#160;</td><td class="mdescRight">Table header renders the title row of a table.  <a href="#a0a483b5fde06ea37439273c4e613012e">More...</a><br /></td></tr>
<tr class="separator:a0a483b5fde06ea37439273c4e613012e inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa73d58d4cf13a95a71a1aa62750022db inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa73d58d4cf13a95a71a1aa62750022db"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1commands_1_1_command.html#aa73d58d4cf13a95a71a1aa62750022db">table_row</a></td></tr>
<tr class="memdesc:aa73d58d4cf13a95a71a1aa62750022db inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="mdescLeft">&#160;</td><td class="mdescRight">Outputs a single row of a table. <br /></td></tr>
<tr class="separator:aa73d58d4cf13a95a71a1aa62750022db inherit pub_methods_classvolatility_1_1commands_1_1_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classvolatility_1_1cache_1_1_testable"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classvolatility_1_1cache_1_1_testable')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classvolatility_1_1cache_1_1_testable.html">volatility.cache.Testable</a></td></tr>
<tr class="memitem:aba96eaa410546bf4141725e26452fbd0 inherit pub_methods_classvolatility_1_1cache_1_1_testable"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aba96eaa410546bf4141725e26452fbd0"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1cache_1_1_testable.html#aba96eaa410546bf4141725e26452fbd0">calculate</a></td></tr>
<tr class="memdesc:aba96eaa410546bf4141725e26452fbd0 inherit pub_methods_classvolatility_1_1cache_1_1_testable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty function used to allow mixin. <br /></td></tr>
<tr class="separator:aba96eaa410546bf4141725e26452fbd0 inherit pub_methods_classvolatility_1_1cache_1_1_testable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a475710251f3414526ce17e99981a4edb inherit pub_methods_classvolatility_1_1cache_1_1_testable"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a475710251f3414526ce17e99981a4edb"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1cache_1_1_testable.html#a475710251f3414526ce17e99981a4edb">test</a></td></tr>
<tr class="memdesc:a475710251f3414526ce17e99981a4edb inherit pub_methods_classvolatility_1_1cache_1_1_testable"><td class="mdescLeft">&#160;</td><td class="mdescRight">This forces the test to be memoised with a key name derived from the class name. <br /></td></tr>
<tr class="separator:a475710251f3414526ce17e99981a4edb inherit pub_methods_classvolatility_1_1cache_1_1_testable"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:af3c77c9d83f58de4738cb407b61fcbd3"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_api_hooks.html#af3c77c9d83f58de4738cb407b61fcbd3">check_syscall</a></td></tr>
<tr class="memdesc:af3c77c9d83f58de4738cb407b61fcbd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerate syscall hooks in ntdll.dll.  <a href="#af3c77c9d83f58de4738cb407b61fcbd3">More...</a><br /></td></tr>
<tr class="separator:af3c77c9d83f58de4738cb407b61fcbd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accf2b49a679bfa8211d9b680088d8f71"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_api_hooks.html#accf2b49a679bfa8211d9b680088d8f71">check_inline</a></td></tr>
<tr class="memdesc:accf2b49a679bfa8211d9b680088d8f71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for inline API hooks.  <a href="#accf2b49a679bfa8211d9b680088d8f71">More...</a><br /></td></tr>
<tr class="separator:accf2b49a679bfa8211d9b680088d8f71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classvolatility_1_1plugins_1_1taskmods_1_1_dll_list.html">volatility.plugins.taskmods.DllList</a></td></tr>
<tr class="memitem:a563f7cbd9be1a9fcb227b5b6eed0af22 inherit pub_static_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a563f7cbd9be1a9fcb227b5b6eed0af22"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1plugins_1_1taskmods_1_1_dll_list.html#a563f7cbd9be1a9fcb227b5b6eed0af22">virtual_process_from_physical_offset</a></td></tr>
<tr class="memdesc:a563f7cbd9be1a9fcb227b5b6eed0af22 inherit pub_static_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a virtual process from a physical offset in memory. <br /></td></tr>
<tr class="separator:a563f7cbd9be1a9fcb227b5b6eed0af22 inherit pub_static_methods_classvolatility_1_1plugins_1_1taskmods_1_1_dll_list"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classvolatility_1_1plugins_1_1common_1_1_abstract_windows_command"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classvolatility_1_1plugins_1_1common_1_1_abstract_windows_command')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classvolatility_1_1plugins_1_1common_1_1_abstract_windows_command.html">volatility.plugins.common.AbstractWindowsCommand</a></td></tr>
<tr class="memitem:a30ed3f3e7f3614bcafdce41d23ebcc52 inherit pub_static_methods_classvolatility_1_1plugins_1_1common_1_1_abstract_windows_command"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a30ed3f3e7f3614bcafdce41d23ebcc52"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>is_valid_profile</b></td></tr>
<tr class="separator:a30ed3f3e7f3614bcafdce41d23ebcc52 inherit pub_static_methods_classvolatility_1_1plugins_1_1common_1_1_abstract_windows_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classvolatility_1_1commands_1_1_command"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classvolatility_1_1commands_1_1_command')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classvolatility_1_1commands_1_1_command.html">volatility.commands.Command</a></td></tr>
<tr class="memitem:a24d5194d0538477ee978c4b27a5a88f7 inherit pub_static_methods_classvolatility_1_1commands_1_1_command"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a24d5194d0538477ee978c4b27a5a88f7"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvolatility_1_1commands_1_1_command.html#a24d5194d0538477ee978c4b27a5a88f7">register_options</a></td></tr>
<tr class="memdesc:a24d5194d0538477ee978c4b27a5a88f7 inherit pub_static_methods_classvolatility_1_1commands_1_1_command"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers options into a config object provided. <br /></td></tr>
<tr class="separator:a24d5194d0538477ee978c4b27a5a88f7 inherit pub_static_methods_classvolatility_1_1commands_1_1_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab8144ff45fed2fc4feee8f3e73fb182 inherit pub_static_methods_classvolatility_1_1commands_1_1_command"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aab8144ff45fed2fc4feee8f3e73fb182"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>is_valid_profile</b></td></tr>
<tr class="separator:aab8144ff45fed2fc4feee8f3e73fb182 inherit pub_static_methods_classvolatility_1_1commands_1_1_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ae98674d8ff416282285c73a444075752"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae98674d8ff416282285c73a444075752"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>compiled_rules</b></td></tr>
<tr class="separator:ae98674d8ff416282285c73a444075752"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09f2e749b9d8a792f5f48df25c180e7b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a09f2e749b9d8a792f5f48df25c180e7b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>critical_process</b></td></tr>
<tr class="separator:a09f2e749b9d8a792f5f48df25c180e7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18929d264360a5718f0222fdd21bfb6a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a18929d264360a5718f0222fdd21bfb6a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>critical_dlls</b></td></tr>
<tr class="separator:a18929d264360a5718f0222fdd21bfb6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09e13d5993789d19df17dccf3bdc5410"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a09e13d5993789d19df17dccf3bdc5410"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ucpscan_modules</b></td></tr>
<tr class="separator:a09e13d5993789d19df17dccf3bdc5410"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_static_attribs_classvolatility_1_1commands_1_1_command"><td colspan="2" onclick="javascript:toggleInherit('pub_static_attribs_classvolatility_1_1commands_1_1_command')"><img src="closed.png" alt="-"/>&#160;Static Public Attributes inherited from <a class="el" href="classvolatility_1_1commands_1_1_command.html">volatility.commands.Command</a></td></tr>
<tr class="memitem:a84510bb8b705ab9cd87b9dd86423e22c inherit pub_static_attribs_classvolatility_1_1commands_1_1_command"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a84510bb8b705ab9cd87b9dd86423e22c"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>op</b> = &quot;&quot;</td></tr>
<tr class="separator:a84510bb8b705ab9cd87b9dd86423e22c inherit pub_static_attribs_classvolatility_1_1commands_1_1_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e0d6624d383553852a7f0d09837ea6a inherit pub_static_attribs_classvolatility_1_1commands_1_1_command"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7e0d6624d383553852a7f0d09837ea6a"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>opts</b> = &quot;&quot;</td></tr>
<tr class="separator:a7e0d6624d383553852a7f0d09837ea6a inherit pub_static_attribs_classvolatility_1_1commands_1_1_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5c4bc066e239cb622b1734f216bfb79 inherit pub_static_attribs_classvolatility_1_1commands_1_1_command"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae5c4bc066e239cb622b1734f216bfb79"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>args</b> = &quot;&quot;</td></tr>
<tr class="separator:ae5c4bc066e239cb622b1734f216bfb79 inherit pub_static_attribs_classvolatility_1_1commands_1_1_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a855482a80289a9f1138144aa23e5288a inherit pub_static_attribs_classvolatility_1_1commands_1_1_command"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a855482a80289a9f1138144aa23e5288a"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>cmdname</b> = &quot;&quot;</td></tr>
<tr class="separator:a855482a80289a9f1138144aa23e5288a inherit pub_static_attribs_classvolatility_1_1commands_1_1_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a087d3c7028c7764b522a0d5632faa48f inherit pub_static_attribs_classvolatility_1_1commands_1_1_command"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a087d3c7028c7764b522a0d5632faa48f"></a>
dictionary&#160;</td><td class="memItemRight" valign="bottom"><b>meta_info</b> = {}</td></tr>
<tr class="separator:a087d3c7028c7764b522a0d5632faa48f inherit pub_static_attribs_classvolatility_1_1commands_1_1_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5e129622fda74b81f6df3c9b5b53cf6 inherit pub_static_attribs_classvolatility_1_1commands_1_1_command"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae5e129622fda74b81f6df3c9b5b53cf6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>elide_data</b> = True</td></tr>
<tr class="separator:ae5e129622fda74b81f6df3c9b5b53cf6 inherit pub_static_attribs_classvolatility_1_1commands_1_1_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b535f5368b94f7c953dfedc76b16178 inherit pub_static_attribs_classvolatility_1_1commands_1_1_command"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4b535f5368b94f7c953dfedc76b16178"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>tablesep</b> = &quot; &quot;</td></tr>
<tr class="separator:a4b535f5368b94f7c953dfedc76b16178 inherit pub_static_attribs_classvolatility_1_1commands_1_1_command"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Detect API hooks in process and kernel memory. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="accf2b49a679bfa8211d9b680088d8f71"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def volatility.plugins.malware.apihooks.ApiHooks.check_inline </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>va</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>addr_space</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mem_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mem_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mode</em> = <code>distorm3.Decode32Bits</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check for inline API hooks. </p>
<p>We check for direct and indirect calls, direct and indirect jumps, and PUSH/RET combinations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">va</td><td>the virtual address of the function to check</td></tr>
    <tr><td class="paramname">addr_space</td><td>process or kernel AS where the function resides</td></tr>
    <tr><td class="paramname">mem_start</td><td>base address of the module containing the function being checked.</td></tr>
    <tr><td class="paramname">mem_end</td><td>end address of the module containing the func being checked.</td></tr>
    <tr><td class="paramname">mode</td><td>32 or 64 bit mode (default: 32)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: a tuple of (hooked, data, hook_address) </dd></dl>

</div>
</div>
<a class="anchor" id="af3c77c9d83f58de4738cb407b61fcbd3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def volatility.plugins.malware.apihooks.ApiHooks.check_syscall </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>addr_space</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>module_group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enumerate syscall hooks in ntdll.dll. </p>
<p>A syscall hook is one that modifies the function prologue of an NT API function (i.e. ntdll!NtCreateFile) or swaps the location of the sysenter with a malicious address.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr_space</td><td>a process AS for the process containing the ntdll.dll module.</td></tr>
    <tr><td class="paramname">module</td><td>the _LDR_DATA_TABLE_ENTRY for ntdll.dll</td></tr>
    <tr><td class="paramname">module_group</td><td>a <a class="el" href="classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_module_group.html" title="A class to assist with module lookups. ">ModuleGroup</a> instance for the process. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a0d204b13397279c39b45316fa6605474"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def volatility.plugins.malware.apihooks.ApiHooks.check_ucpcall </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>addr_space</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>module_group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Scan for calls to unknown code pages. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr_space</td><td>a kernel AS</td></tr>
    <tr><td class="paramname">module</td><td>the _LDR_DATA_TABLE_ENTRY to scan</td></tr>
    <tr><td class="paramname">module_group</td><td>a <a class="el" href="classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_module_group.html" title="A class to assist with module lookups. ">ModuleGroup</a> instance for the process. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5de35852004115e823a6d9ab67457e63"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def volatility.plugins.malware.apihooks.ApiHooks.check_wsp </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>addr_space</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>module_group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check for hooks of non-exported WSP* functions. </p>
<p>The mswsock.dll module contains a global variable which points to all the internal Winsock functions. We find the function table by the reference from the exported WSPStartup API.</p>
<p>.text:6C88922E 8B 7D 50 mov edi, [ebp+lpProcTable] .text:6C889231 6A 1E push 1Eh .text:6C889233 59 pop ecx .text:6C889234 BE 40 64 8B 6C mov esi, offset _SockProcTable .text:6C889239 F3 A5 rep movsd</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr_space</td><td>process AS</td></tr>
    <tr><td class="paramname">module</td><td>the _LDR_DATA_TABLE_ENTRY for mswsock.dll</td></tr>
    <tr><td class="paramname">module_group</td><td>a <a class="el" href="classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_module_group.html" title="A class to assist with module lookups. ">ModuleGroup</a> instance for the process. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4a4a5f5a13fdb49cb639b2ac60411dd0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def volatility.plugins.malware.apihooks.ApiHooks.compile </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Precompile the regular expression rules. </p>
<p>Its quicker if we do this once per plugin run, rather than once per API hook that needs checking. </p>

</div>
</div>
<a class="anchor" id="ae71ed2a9b0571ade282efd07c5c4b46f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def volatility.plugins.malware.apihooks.ApiHooks.gather_stuff </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>_addr_space</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>module</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use the Volatility object classes to enumerate imports and exports. </p>
<p>This function can be overriden to use pefile instead for speed testing </p>

</div>
</div>
<a class="anchor" id="afd27c2da01b9f5b3091f5ccef25a6448"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def volatility.plugins.malware.apihooks.ApiHooks.get_hooks </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hook_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>addr_space</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>module_group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumerate IAT, EAT, Inline hooks. </p>
<p>Also acts as a dispatcher for NT syscall, UCP scans, and winsock procedure table hooks.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hook_mode</td><td>one of the HOOK_MODE_* constants</td></tr>
    <tr><td class="paramname">addr_space</td><td>a process AS or kernel AS</td></tr>
    <tr><td class="paramname">module</td><td>an _LDR_DATA_TABLE_ENTRY for the module being checked for hooks.</td></tr>
    <tr><td class="paramname">module_group</td><td>a <a class="el" href="classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_module_group.html" title="A class to assist with module lookups. ">ModuleGroup</a> instance for the process. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8f413f572e43b591dee349f8ad1ba780"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def volatility.plugins.malware.apihooks.ApiHooks.whitelist </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rule_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>src_mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dst_mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>function</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if an API hook should be ignored due to whitelisting. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rule_key</td><td>a key from the whitelist_rules dictionary which describes the type of hook (i.e. Usermode IAT or Kernel Inline).</td></tr>
    <tr><td class="paramname">process</td><td>name of the suspected victim process.</td></tr>
    <tr><td class="paramname">src_mod</td><td>name of the source module whose function has been hooked. this varies depending on whether we're dealing with IAT EAT, inline, etc.</td></tr>
    <tr><td class="paramname">dst_mod</td><td>name of the module that is the destination of the hook pointer. this is usually the rootkit dll, exe, or sys, however, in many cases there is no module name since the rootkit is trying to be stealthy.</td></tr>
    <tr><td class="paramname">function</td><td>name of the function that has been hooked. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>volatility/plugins/malware/apihooks.py</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>volatility</b></li><li class="navelem"><b>plugins</b></li><li class="navelem"><b>malware</b></li><li class="navelem"><b>apihooks</b></li><li class="navelem"><a class="el" href="classvolatility_1_1plugins_1_1malware_1_1apihooks_1_1_api_hooks.html">ApiHooks</a></li>
    <li class="footer">Generated on Fri Sep 5 2014 15:58:22 for The Volatility Framework by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
